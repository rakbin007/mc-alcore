{"ast":null,"code":"import _createClass from \"@babel/runtime/helpers/createClass\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _wrapNativeSuper from \"@babel/runtime/helpers/wrapNativeSuper\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nimport { PermissionStatus, Platform } from 'expo-modules-core';\nexport function getPermissionsAsync() {\n  return _getPermissionsAsync.apply(this, arguments);\n}\nfunction _getPermissionsAsync() {\n  _getPermissionsAsync = _asyncToGenerator(function* () {\n    var status = getRequestPermission() ? PermissionStatus.UNDETERMINED : isIOS() ? PermissionStatus.DENIED : PermissionStatus.GRANTED;\n    return {\n      status: status,\n      expires: 'never',\n      canAskAgain: true,\n      granted: status === PermissionStatus.GRANTED\n    };\n  });\n  return _getPermissionsAsync.apply(this, arguments);\n}\nexport function requestPermissionsAsync() {\n  return _requestPermissionsAsync.apply(this, arguments);\n}\nfunction _requestPermissionsAsync() {\n  _requestPermissionsAsync = _asyncToGenerator(function* () {\n    var status = yield askSensorPermissionAsync();\n    return {\n      status: status,\n      expires: 'never',\n      granted: status === PermissionStatus.GRANTED,\n      canAskAgain: false\n    };\n  });\n  return _requestPermissionsAsync.apply(this, arguments);\n}\nfunction askSensorPermissionAsync() {\n  return _askSensorPermissionAsync.apply(this, arguments);\n}\nfunction _askSensorPermissionAsync() {\n  _askSensorPermissionAsync = _asyncToGenerator(function* () {\n    var requestPermission = getRequestPermission();\n    if (!requestPermission) return PermissionStatus.GRANTED;\n    var status = yield requestPermission();\n    switch (status) {\n      case 'granted':\n        return PermissionStatus.GRANTED;\n      case 'denied':\n        return PermissionStatus.DENIED;\n      default:\n        return PermissionStatus.UNDETERMINED;\n    }\n  });\n  return _askSensorPermissionAsync.apply(this, arguments);\n}\nexport function getRequestPermission() {\n  var _DeviceMotionEvent, _DeviceOrientationEve;\n  if (!Platform.isDOMAvailable) {\n    return null;\n  }\n  if (typeof DeviceMotionEvent !== 'undefined' && !!((_DeviceMotionEvent = DeviceMotionEvent) != null && _DeviceMotionEvent.requestPermission)) {\n    return DeviceMotionEvent.requestPermission;\n  } else if (typeof DeviceOrientationEvent !== 'undefined' && !!((_DeviceOrientationEve = DeviceOrientationEvent) != null && _DeviceOrientationEve.requestPermission)) {\n    return DeviceOrientationEvent.requestPermission;\n  }\n  return null;\n}\nvar PermissionError = function (_Error) {\n  _inherits(PermissionError, _Error);\n  var _super = _createSuper(PermissionError);\n  function PermissionError(eventName) {\n    _classCallCheck(this, PermissionError);\n    var errorMessage = \"Cannot observe event: \" + eventName + \". How to fix:\";\n    errorMessage += \"\\n- Ensure you've requested the `MOTION` permission via expo-permissions (this must be done in a touch event).\";\n    if (location.protocol !== 'https:') {\n      errorMessage += '\\n- Ensure that you are hosting with `https` as DeviceMotion and DeviceOrientation are now secure APIs.';\n    }\n    if (isIOS() && !getRequestPermission()) {\n      errorMessage += '\\n- On iOS 12.2, you must manually enable device orientation in `Settings > Safari > Motion & Orientation Access`.';\n    }\n    return _super.call(this, errorMessage);\n  }\n  return _createClass(PermissionError);\n}(_wrapNativeSuper(Error));\nexport function assertSensorEventEnabledAsync(_x, _x2) {\n  return _assertSensorEventEnabledAsync.apply(this, arguments);\n}\nfunction _assertSensorEventEnabledAsync() {\n  _assertSensorEventEnabledAsync = _asyncToGenerator(function* (eventName, timeout) {\n    if (!Platform.isDOMAvailable) {\n      return false;\n    }\n    if (getRequestPermission()) {\n      if (yield isSensorEnabledAsync(eventName, timeout)) {\n        return true;\n      }\n      throw new PermissionError(eventName);\n    }\n    return true;\n  });\n  return _assertSensorEventEnabledAsync.apply(this, arguments);\n}\nexport function isSensorEnabledAsync(_x3) {\n  return _isSensorEnabledAsync.apply(this, arguments);\n}\nfunction _isSensorEnabledAsync() {\n  _isSensorEnabledAsync = _asyncToGenerator(function* (eventName) {\n    var timeout = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 250;\n    if (!Platform.isDOMAvailable) {\n      return false;\n    }\n    if (!isIOS && !getRequestPermission()) {\n      return true;\n    }\n    return new Promise(function (resolve) {\n      var id = setTimeout(function () {\n        window.removeEventListener(eventName, listener);\n        resolve(false);\n      }, timeout);\n      var listener = function listener() {\n        clearTimeout(id);\n        window.removeEventListener(eventName, listener);\n        resolve(true);\n      };\n      window.addEventListener(eventName, listener);\n    });\n  });\n  return _isSensorEnabledAsync.apply(this, arguments);\n}\nfunction isIOS() {\n  var isIOSUA = /(iPad|iPhone|iPod)/g.test(navigator.userAgent);\n  var isIE11 = !!window['MSStream'];\n  return isIOSUA && !isIE11;\n}","map":{"version":3,"names":["PermissionStatus","Platform","getPermissionsAsync","_getPermissionsAsync","apply","arguments","_asyncToGenerator","status","getRequestPermission","UNDETERMINED","isIOS","DENIED","GRANTED","expires","canAskAgain","granted","requestPermissionsAsync","_requestPermissionsAsync","askSensorPermissionAsync","_askSensorPermissionAsync","requestPermission","_DeviceMotionEvent","_DeviceOrientationEve","isDOMAvailable","DeviceMotionEvent","DeviceOrientationEvent","PermissionError","_Error","_inherits","_super","_createSuper","eventName","_classCallCheck","errorMessage","location","protocol","call","_createClass","_wrapNativeSuper","Error","assertSensorEventEnabledAsync","_x","_x2","_assertSensorEventEnabledAsync","timeout","isSensorEnabledAsync","_x3","_isSensorEnabledAsync","length","undefined","Promise","resolve","id","setTimeout","window","removeEventListener","listener","clearTimeout","addEventListener","isIOSUA","test","navigator","userAgent","isIE11"],"sources":["/Users/rbsung/Documents/mobile-computing/final/node_modules/expo-sensors/src/utils/isSensorEnabledAsync.web.ts"],"sourcesContent":["import { PermissionResponse, PermissionStatus, Platform } from 'expo-modules-core';\n\ntype SensorEventName = 'deviceorientation' | 'devicemotion';\n\nexport async function getPermissionsAsync(): Promise<PermissionResponse> {\n  // We can infer from the requestor if this is an older browser.\n  const status = getRequestPermission()\n    ? PermissionStatus.UNDETERMINED\n    : isIOS()\n    ? PermissionStatus.DENIED\n    : PermissionStatus.GRANTED;\n  return {\n    status,\n    expires: 'never',\n    canAskAgain: true,\n    granted: status === PermissionStatus.GRANTED,\n  };\n}\n\nexport async function requestPermissionsAsync(): Promise<PermissionResponse> {\n  const status = await askSensorPermissionAsync();\n  return {\n    status,\n    expires: 'never',\n    granted: status === PermissionStatus.GRANTED,\n    canAskAgain: false,\n  };\n}\n\nasync function askSensorPermissionAsync(): Promise<PermissionStatus> {\n  const requestPermission = getRequestPermission();\n  // Technically this is incorrect because it doesn't account for iOS 12.2 Safari.\n  // But unfortunately we can only abstract so much.\n  if (!requestPermission) return PermissionStatus.GRANTED;\n\n  // If this isn't invoked in a touch-event then it never resolves.\n  // Safari probably should throw an error but because it doesn't we have no way of informing the developer.\n  const status = await requestPermission();\n  switch (status) {\n    case 'granted':\n      return PermissionStatus.GRANTED;\n    case 'denied':\n      return PermissionStatus.DENIED;\n    default:\n      return PermissionStatus.UNDETERMINED;\n  }\n}\n\n/**\n * Temporary solution until `tslib.d.ts` is updated to include the new DeviceOrientation/DeviceMotion API (as of 2021.10.26 it's not implemented completely, it's in experimental state).\n *\n * `typescript@4.4.4` is missing `requestPermission` described in\n * - https://w3c.github.io/deviceorientation/#deviceorientation\n * - https://w3c.github.io/deviceorientation/#devicemotion\n *\n * MDN docs does not describe this property as well:\n * - https://developer.mozilla.org/en-US/docs/Web/API/DeviceOrientationEvent\n * - https://developer.mozilla.org/en-US/docs/Web/API/DeviceMotionEvent\n *\n * Below are just redefinitions of the existing typing available in the:\n * - https://github.com/microsoft/TypeScript/blob/01de6ff2ecdc6175727f7f999b887519d40ca115/lib/lib.dom.d.ts#L4216\n * - https://github.com/microsoft/TypeScript/blob/01de6ff2ecdc6175727f7f999b887519d40ca115/lib/lib.dom.d.ts#L4241.\n */\ndeclare let DeviceMotionEvent: {\n  prototype: DeviceMotionEvent;\n  new (type: string, eventInitDict?: DeviceMotionEventInit): DeviceMotionEvent;\n  requestPermission?: () => Promise<PermissionState>;\n};\n/**\n * See `DeviceMotionEvent` description a few lines above.\n */\ndeclare let DeviceOrientationEvent: {\n  prototype: DeviceOrientationEvent;\n  new (type: string, eventInitDict?: DeviceOrientationEventInit): DeviceOrientationEvent;\n  requestPermission?: () => Promise<PermissionState>;\n};\n\nexport function getRequestPermission(): (() => Promise<PermissionState>) | null {\n  if (!Platform.isDOMAvailable) {\n    return null;\n  }\n\n  if (typeof DeviceMotionEvent !== 'undefined' && !!DeviceMotionEvent?.requestPermission) {\n    return DeviceMotionEvent.requestPermission;\n  } else if (\n    typeof DeviceOrientationEvent !== 'undefined' &&\n    !!DeviceOrientationEvent?.requestPermission\n  ) {\n    return DeviceOrientationEvent.requestPermission;\n  }\n\n  return null;\n}\n\nclass PermissionError extends Error {\n  constructor(eventName: string) {\n    let errorMessage = `Cannot observe event: ${eventName}. How to fix:`;\n\n    errorMessage += `\\n- Ensure you've requested the \\`MOTION\\` permission via expo-permissions (this must be done in a touch event).`;\n\n    if (location.protocol !== 'https:') {\n      errorMessage +=\n        '\\n- Ensure that you are hosting with `https` as DeviceMotion and DeviceOrientation are now secure APIs.';\n    }\n    // is iOS and doesn't support requesting permissions, must be 12.2\n    if (isIOS() && !getRequestPermission()) {\n      errorMessage +=\n        '\\n- On iOS 12.2, you must manually enable device orientation in `Settings > Safari > Motion & Orientation Access`.';\n    }\n\n    super(errorMessage);\n  }\n}\n\n// iOS 12.2 disables DeviceMotion by default now\n// https://github.com/w3c/deviceorientation/issues/57\nexport async function assertSensorEventEnabledAsync(\n  eventName: SensorEventName,\n  timeout?: number\n): Promise<boolean> {\n  if (!Platform.isDOMAvailable) {\n    return false;\n  }\n\n  if (getRequestPermission()) {\n    if (await isSensorEnabledAsync(eventName, timeout)) {\n      return true;\n    }\n    throw new PermissionError(eventName);\n  }\n  return true;\n}\n\n// throw error if the sensor is disabled.\nexport async function isSensorEnabledAsync(\n  eventName: SensorEventName,\n  // Initial interval tests found results on a median of\n  // devicemotion:\n  // - iPhone 7 Plus: 166.6666753590107ms\n  // - iPhone X: 166.6666753590107ms\n  // deviceorientation:\n  // -\n  //\n  // The initial launch of iOS Safari onto a page calling this API seems to take a little longer than a regular call.\n  // devicemotion:\n  // - ~35ms\n  // deviceorientation:\n  // - ~45ms\n  //\n  timeout: number = 250\n): Promise<boolean> {\n  if (!Platform.isDOMAvailable) {\n    return false;\n  }\n\n  // If there is no method to request permission then the device has access to device motion.\n  // Older versions of iOS have no method but still disable motion so we should always check on iOS.\n  if (!isIOS && !getRequestPermission()) {\n    return true;\n  }\n\n  return new Promise((resolve) => {\n    const id = setTimeout(() => {\n      window.removeEventListener(eventName, listener);\n      resolve(false);\n    }, timeout);\n\n    const listener = (): void => {\n      clearTimeout(id);\n      window.removeEventListener(eventName, listener);\n      resolve(true);\n    };\n\n    window.addEventListener(eventName, listener);\n  });\n}\n\n// https://stackoverflow.com/a/9039885/4047926\nfunction isIOS(): boolean {\n  const isIOSUA = /(iPad|iPhone|iPod)/g.test(navigator.userAgent);\n  const isIE11 = !!window['MSStream'];\n  return isIOSUA && !isIE11;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}